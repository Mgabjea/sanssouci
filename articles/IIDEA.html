<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IIDEA: Interactive Inference for Differential Expression Analyses • sansSouci</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="IIDEA: Interactive Inference for Differential Expression Analyses">
<meta property="og:description" content="sansSouci">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sansSouci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IIDEA.html">IIDEA: Interactive Inference for Differential Expression Analyses</a>
    </li>
    <li>
      <a href="../articles/Simes_equi-correlation.html">Conservativeness of the Simes inequality under positive dependence</a>
    </li>
    <li>
      <a href="../articles/confidenceEnvelopes_localized.html">Confidence envelopes for spatially structured hypotheses</a>
    </li>
    <li>
      <a href="../articles/jointErrorRateCalibration_simulations.html">Joint Error Rate calibration</a>
    </li>
    <li>
      <a href="../articles/post-hoc_differential-expression.html">Permutation-based post hoc inference for differential gene expression studies</a>
    </li>
    <li>
      <a href="../articles/post-hoc_fMRI.html">Permutation-based post hoc inference for fMRI studies</a>
    </li>
    <li>
      <a href="../articles/stepDownControl.html">Step-down joint Family-Wise Error Rate control</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pneuvial/sanssouci/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="IIDEA_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>IIDEA: Interactive Inference for Differential Expression Analyses</h1>
                        <h4 class="author">Nicolas Enjalbert-Courrech and Pierre Neuvial</h4>
            
            <h4 class="date">2020-12-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pneuvial/sanssouci/blob/master/vignettes/IIDEA.Rmd"><code>vignettes/IIDEA.Rmd</code></a></small>
      <div class="hidden name"><code>IIDEA.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette provides guidelines for using the <a href="https://pneuvial.shinyapps.io/volcano-plot/">IIDEA shiny application</a>. In the context of differential gene expression studies, this interactive application combines volcano plots with enrichment analyses.</p>
<p>The main distinctive feature of this app is that it makes it possible for users to interactively select genes of interest (either from the volcano plotor corresponding to a particular gene set) and obtain valid statistical guarantees regarding the number of true/false positives among these genes (see Methods section below).</p>
</div>
<div id="quick-start" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h1>
<ul>
<li>Open the <a href="https://pneuvial.shinyapps.io/volcano-plot/">IIDEA shiny application</a>
</li>
<li>Click on ‘Run!’</li>
</ul>
<blockquote>
<p>This launches the analysis of an example data set (described below): a volcano plot is displayed in the right panel, together with a table at the bottom of the left panel.</p>
</blockquote>
<p><img src="img/IIDEA_overview.png" width="600px"></p>
<div id="interactive-statistical-guarantees" class="section level2">
<h2 class="hasAnchor">
<a href="#interactive-statistical-guarantees" class="anchor"></a>Interactive statistical guarantees</h2>
<div id="default-output" class="section level3">
<h3 class="hasAnchor">
<a href="#default-output" class="anchor"></a>Default output</h3>
<p><img src="img/IIDEA_post-hoc-table.png" width="400px"></p>
<p>The table displays, for each user selection of a set of genes, the following statistical gaurantees:</p>
<ul>
<li>
<strong>TP<span class="math inline">\(\geq\)</span></strong>: there are at least 57 truly differentially expressed genes (True Positives, TP) among the 70 genes selected in the volcano plot.</li>
<li>
<strong>FDP<span class="math inline">\(\leq\)</span></strong>: the proportion of genes erroneously called differentially expressed among those selected (False Discovery Proportion, FDP) is less than 19%</li>
</ul>
</div>
<div id="user-selections" class="section level3">
<h3 class="hasAnchor">
<a href="#user-selections" class="anchor"></a>User selections</h3>
<ul>
<li>Select a set of genes of interest by dragging and dropping the horizonal and vertical bars, or by making a rectangular or a “lasso” selection.</li>
</ul>
<blockquote>
<ul>
<li>The table is updated with this selection.</li>
<li>Clicking on the line corresponding to a gene selection highlights the corresponding genes in the volcano plot</li>
<li>Clicking on the name of a gene selection in the table opens a new window with the corresponding set of genes displayed by <a href="https://string-db.org/">StringDB</a>
</li>
<li>User selections can be downloaded as a CSV file</li>
</ul>
</blockquote>
</div>
</div>
<div id="gene-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-sets" class="anchor"></a>Gene sets</h2>
<ul>
<li>Click on the ‘Gene sets’ tab in the left panel.</li>
</ul>
<blockquote>
<p>The table at the bottom of the left panel now displays statistical guarantees obtained by post hoc bounds for a list of GO terms Clicking on a GO term highlights the corresponding genes in the volcano plot</p>
</blockquote>
</div>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h2>
<p>By default (i.e. when “Use demo data” is checked), we consider a data set studied in <span class="citation">Bourgon, Gentleman, and Huber (2010)</span>.</p>
<p>This data set consists of gene expression measurements for <span class="math inline">\(n = 79\)</span> patients with B-cell acute lymphoblastic leukemia (ALL) <span class="citation">Chiaretti et al. (2005)</span>. These patients are classified into two subgoups, depending on whether or not they harbor a specific mutation called “BCR/ABL”. In this example, differential expression is applied by performing a statistical test of equality of means to each gene.</p>
<p>This data set is available from the R package <a href="https://github.com/pneuvial/sanssouci.data"><code>sansSouci.data</code></a>.</p>
</div>
<div id="user-data" class="section level2">
<h2 class="hasAnchor">
<a href="#user-data" class="anchor"></a>User data</h2>
<ul>
<li>Uncheck “Use demo data”: you will be able to upload your own gene expression data, and optionally a file containing gene sets of interest (for example obtained from Gene Ontology). The file format is described in the app, and example data files are also provided.</li>
</ul>
</div>
</div>
<div id="methods" class="section level1">
<h1 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h1>
<p>IIDEA leverages post hoc inference methods implemented in the R package <a href="https://github.com/pneuvial/sanssouci"><code>sansSouci</code></a>.</p>
<p>Post hoc inference is a recent field stemming from the multiple testing literature where users are allowed to freely select hypotheses of interest after “seeing the data”, without compromising statistical validity despite the issue of “cherry-picking” (<span class="citation">Blanchard, Neuvial, and Roquain (2019)</span>, <span class="citation">Blanchard, Neuvial, and Roquain (2020)</span>, <span class="citation">Goeman and Solari (2011)</span>).</p>
<p>The methods implemented by IIDEA allow for valid inference without requiring assumptions on the dependence between genes. Instead, such dependencies are <em>estimated</em> from the data using permutation techniques, making our methods both mathematically valid and statistically powerful (see e.g. <a href="https://pneuvial.github.io/sanssouci/articles/post-hoc_differential-expression.html" class="uri">https://pneuvial.github.io/sanssouci/articles/post-hoc_differential-expression.html</a>).</p>
<p>The parameters for this estimation step can be customized by clicking “Advanced parameters”.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-blanchard20post-hoc">
<p>Blanchard, Gilles, Pierre Neuvial, and Etienne Roquain. 2020. “Post Hoc Confidence Bounds on False Positives Using Reference Families.” <em>Annals of Statistics</em> 48 (3): 1281–1303. <a href="https://projecteuclid.org/euclid.aos/1594972818">https://projecteuclid.org/euclid.aos/1594972818</a>.</p>
</div>
<div id="ref-BNR:chap">
<p>———. 2019. “On Agnostic Post Hoc Approaches to False Positive Control.” <a href="https://hal.archives-ouvertes.fr/hal-02320543">https://hal.archives-ouvertes.fr/hal-02320543</a>.</p>
</div>
<div id="ref-BGH2010">
<p>Bourgon, Richard, Robert Gentleman, and Wolfgang Huber. 2010. “Independent filtering increases detection power for high-throughput experiments.” <em>PNAS</em>. <a href="https://doi.org/10.1073/pnas.0914005107/-/DCSupplemental.www.pnas.org/cgi/doi/10.1073/pnas.0914005107">https://doi.org/10.1073/pnas.0914005107/-/DCSupplemental.www.pnas.org/cgi/doi/10.1073/pnas.0914005107</a>.</p>
</div>
<div id="ref-CLGV+2005">
<p>Chiaretti, Sabina, Xiaochun Li, Robert Gentleman, Antonella Vitale, Kathy S Wang, Franco Mandelli, Robin Foa, and Jerome Ritz. 2005. “Gene Expression Profiles of B-Lineage Adult Acute Lymphocytic Leukemia Reveal Genetic Patterns That Identify Lineage Derivation and Distinct Mechanisms of Transformation.” <em>Clinical Cancer Research</em> 11 (20): 7209–19.</p>
</div>
<div id="ref-GS2011">
<p>Goeman, Jelle J, and Aldo Solari. 2011. “Multiple Testing for Exploratory Research.” <em>Statistical Science</em> 26 (4): 584–97.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gilles Blanchard, Guillermo Durand, <a href="https://www.math.univ-toulouse.fr/~pneuvial/">Pierre Neuvial</a>, <a href="https://etienneroquain-81.webself.net/">Etienne Roquain</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
