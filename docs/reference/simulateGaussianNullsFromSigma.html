<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>simulateGaussianNullsFromSigma — simulateGaussianNullsFromSigma • sansSouci</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sansSouci</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/postHocBoundAlgo.html">Efficient calculation of a post hoc confidence bound</a>
    </li>
    <li>
      <a href="../articles/stepDownControl.html">Step-down joint Family-Wise Error Rate control</a>
    </li>
    <li>
      <a href="../articles/two-sample.html">Post hoc inference for multiple two-sample tests</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>simulateGaussianNullsFromSigma</h1>
    </div>

    
    <p>Simulate m observations of a p-dimensional Gaussian vector with given
covariance matrix</p>
    

    <pre class="usage"><span class='fu'>simulateGaussianNullsFromSigma</span>(<span class='no'>Sigma</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Sigma</th>
      <td><p>Population covariance matrix (of size <code>m x m</code>)</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of replications of the simulation</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>m x n</code> <code>Matrix</code> simulated test statistics, where
<code>m</code> is the dimension of <code>Sigma</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>library</span>(<span class='st'>"Matrix"</span>)
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>

<span class='co'>## Toeplitz, short range</span>
<span class='no'>tcoefs</span> <span class='kw'>&lt;-</span> <span class='fu'>toeplitz</span>((<span class='fl'>1</span>:<span class='no'>m</span>)^(-<span class='fl'>2</span>))
<span class='no'>Sigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/Matrix/topics/Matrix'>Matrix</a></span>(<span class='no'>tcoefs</span>, <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'>simulateGaussianNullsFromSigma</span>(<span class='no'>Sigma</span>, <span class='no'>n</span>)
<span class='fu'>str</span>(<span class='no'>Y</span>)</div><div class='output co'>#&gt;  num [1:100, 1:1000] 0.198 0.367 0.621 -0.695 -1.422 ...</div><div class='input'>
<span class='no'>SigmaHat</span> <span class='kw'>&lt;-</span> <span class='no'>Y</span> <span class='kw'>%*%</span> <span class='fu'>t</span>(<span class='no'>Y</span>)/<span class='no'>n</span>
<span class='fu'>image</span>(<span class='no'>SigmaHat</span>)</div><div class='img'><img src='simulateGaussianNullsFromSigma-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'><span class='fu'>image</span>(<span class='no'>Sigma</span>)</div><div class='img'><img src='simulateGaussianNullsFromSigma-2.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='fu'>svd</span>(<span class='no'>SigmaHat</span>)$<span class='no'>d</span></div><div class='output co'>#&gt;   [1] 2.6197906 2.4807008 2.4212676 2.2194276 2.1675996 2.1218324 2.0617269
#&gt;   [8] 1.9334601 1.8581555 1.8401665 1.8101895 1.7218575 1.6436610 1.6069261
#&gt;  [15] 1.5645576 1.5415229 1.4847527 1.4778749 1.4552866 1.4143010 1.3860356
#&gt;  [22] 1.3446108 1.3025333 1.2682125 1.2446937 1.2136287 1.2053667 1.1910516
#&gt;  [29] 1.1550009 1.1478922 1.1345771 1.1016002 1.0877081 1.0727416 1.0599054
#&gt;  [36] 1.0494096 1.0445324 1.0036010 0.9986258 0.9771920 0.9596176 0.9500868
#&gt;  [43] 0.9365378 0.9301238 0.9231806 0.9159956 0.8980133 0.8839464 0.8728596
#&gt;  [50] 0.8564019 0.8440781 0.8284210 0.8257963 0.8113899 0.8092004 0.7882490
#&gt;  [57] 0.7772095 0.7655445 0.7593793 0.7371664 0.7347511 0.7273153 0.7132137
#&gt;  [64] 0.7057275 0.6935595 0.6874909 0.6752045 0.6671942 0.6537013 0.6470203
#&gt;  [71] 0.6292407 0.6222530 0.6180588 0.6136587 0.6039130 0.5975651 0.5917036
#&gt;  [78] 0.5834295 0.5721181 0.5504481 0.5464368 0.5350361 0.5330931 0.5246890
#&gt;  [85] 0.5121389 0.5075343 0.5029564 0.4966942 0.4914000 0.4811240 0.4730667
#&gt;  [92] 0.4515290 0.4414715 0.4381797 0.4266781 0.4150497 0.4026619 0.3935158
#&gt;  [99] 0.3812849 0.3718655</div><div class='input'>(<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'>svd</span>(<span class='no'>Sigma</span>)$<span class='no'>d</span>)</div><div class='output co'>#&gt;   [1] 2.2247332 2.1419795 2.0682744 1.9997120 1.9364782 1.8773238 1.8221125
#&gt;   [8] 1.7701725 1.7213510 1.6752189 1.6316419 1.5903205 1.5511417 1.5138840
#&gt;  [15] 1.4784532 1.4446790 1.4124825 1.3817292 1.3523523 1.3242433 1.2973455
#&gt;  [22] 1.2715697 1.2468673 1.2231642 1.2004182 1.1785671 1.1575743 1.1373869
#&gt;  [29] 1.1179728 1.0992866 1.0813005 1.0639751 1.0472858 1.0311984 1.0156912
#&gt;  [36] 1.0007344 0.9863085 0.9723874 0.9589538 0.9459847 0.9334645 0.9213728
#&gt;  [43] 0.9096958 0.8984154 0.8875189 0.8769904 0.8668184 0.8569886 0.8474909
#&gt;  [50] 0.8383122 0.8294433 0.8208727 0.8125920 0.8045908 0.7968614 0.7893945
#&gt;  [57] 0.7821833 0.7752191 0.7684958 0.7620057 0.7557430 0.7497010 0.7438743
#&gt;  [64] 0.7382568 0.7328436 0.7276292 0.7226092 0.7177786 0.7131333 0.7086689
#&gt;  [71] 0.7043818 0.7002677 0.6963235 0.6925454 0.6889304 0.6854754 0.6821775
#&gt;  [78] 0.6790338 0.6760419 0.6731991 0.6705033 0.6679521 0.6655437 0.6632759
#&gt;  [85] 0.6611471 0.6591554 0.6572995 0.6555776 0.6539887 0.6525313 0.6512043
#&gt;  [92] 0.6500068 0.6489379 0.6479965 0.6471822 0.6464942 0.6459320 0.6454951
#&gt;  [99] 0.6451834 0.6449964</div><div class='input'><span class='fu'>max</span>(<span class='no'>ss</span>)/<span class='fu'>min</span>(<span class='no'>ss</span>)</div><div class='output co'>#&gt; [1] 3.449218</div><div class='input'>

<span class='co'>## Toeplitz, long range</span>
<span class='no'>tcoefs</span> <span class='kw'>&lt;-</span> <span class='fu'>toeplitz</span>((<span class='fl'>1</span>:<span class='no'>m</span>)^(-<span class='fl'>.1</span>))
<span class='no'>Sigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/Matrix/topics/Matrix'>Matrix</a></span>(<span class='no'>tcoefs</span>, <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'>simulateGaussianNullsFromSigma</span>(<span class='no'>Sigma</span>, <span class='no'>n</span>)
<span class='fu'>str</span>(<span class='no'>Y</span>)</div><div class='output co'>#&gt;  num [1:100, 1:1000] -0.919 0.103 -0.423 -1.326 -1.301 ...</div><div class='input'>
<span class='no'>SigmaHat</span> <span class='kw'>&lt;-</span> <span class='no'>Y</span> <span class='kw'>%*%</span> <span class='fu'>t</span>(<span class='no'>Y</span>)/<span class='no'>n</span>
<span class='fu'>image</span>(<span class='no'>SigmaHat</span>)</div><div class='img'><img src='simulateGaussianNullsFromSigma-3.png' alt='' width='700' height='432.632880098887' /></div><div class='input'><span class='fu'>image</span>(<span class='no'>Sigma</span>)</div><div class='img'><img src='simulateGaussianNullsFromSigma-4.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='fu'>svd</span>(<span class='no'>SigmaHat</span>)$<span class='no'>d</span></div><div class='output co'>#&gt;   [1] 67.22445079  5.13421511  3.25011157  2.12162311  1.46787012  1.14353324
#&gt;   [7]  1.04742158  0.86519920  0.75855554  0.64833646  0.57813680  0.52915837
#&gt;  [13]  0.44635810  0.38654336  0.37170878  0.35110397  0.31636212  0.29338497
#&gt;  [19]  0.29074120  0.24878533  0.24667732  0.23050824  0.21294131  0.20191735
#&gt;  [25]  0.19066018  0.18185372  0.18051270  0.16416630  0.15531799  0.15057656
#&gt;  [31]  0.14352458  0.13499399  0.12907134  0.12297808  0.12241979  0.12130050
#&gt;  [37]  0.11471013  0.11138923  0.10644796  0.10423894  0.10010030  0.09816994
#&gt;  [43]  0.09515782  0.09354845  0.09019536  0.08752021  0.08658901  0.08405076
#&gt;  [49]  0.08238272  0.07914319  0.07673415  0.07501247  0.07368669  0.07217140
#&gt;  [55]  0.06962832  0.06780303  0.06634355  0.06348256  0.06244188  0.06224617
#&gt;  [61]  0.06139184  0.06060327  0.05930280  0.05919087  0.05800113  0.05736527
#&gt;  [67]  0.05644890  0.05470672  0.05257827  0.05186971  0.05115706  0.05017867
#&gt;  [73]  0.04882489  0.04838837  0.04764177  0.04673364  0.04625827  0.04580888
#&gt;  [79]  0.04496970  0.04491004  0.04394234  0.04279550  0.04262589  0.04198509
#&gt;  [85]  0.04037142  0.03960494  0.03859142  0.03815359  0.03778248  0.03652407
#&gt;  [91]  0.03607589  0.03538331  0.03452328  0.03374620  0.03325860  0.03254920
#&gt;  [97]  0.03194074  0.03136286  0.02948415  0.02899205</div><div class='input'>(<span class='no'>sl</span> <span class='kw'>&lt;-</span> <span class='fu'>svd</span>(<span class='no'>Sigma</span>)$<span class='no'>d</span>)</div><div class='output co'>#&gt;   [1] 73.01012603  5.28991559  3.07620224  2.05419269  1.55947264  1.22743712
#&gt;   [7]  1.01499679  0.85339459  0.73682547  0.64234909  0.56944002  0.50803438
#&gt;  [13]  0.45853935  0.41576260  0.38021685  0.34891962  0.32231974  0.29856830
#&gt;  [19]  0.27802747  0.25948400  0.24322370  0.22841462  0.21528164  0.20323396
#&gt;  [25]  0.19244927  0.18249590  0.17351522  0.16518433  0.15761657  0.15056559
#&gt;  [31]  0.14412296  0.13809754  0.13256386  0.12737147  0.12258145  0.11807391
#&gt;  [37]  0.11389919  0.10996072  0.10630022  0.10283918  0.09961235  0.09655535
#&gt;  [43]  0.09369726  0.09098492  0.08844273  0.08602653  0.08375685  0.08159682
#&gt;  [49]  0.07956375  0.07762668  0.07580027  0.07405842  0.07241354  0.07084355
#&gt;  [55]  0.06935896  0.06794107  0.06659876  0.06531614  0.06410074  0.06293901
#&gt;  [61]  0.06183732  0.06078414  0.05978482  0.05882955  0.05792281  0.05705624
#&gt;  [67]  0.05623360  0.05544775  0.05470183  0.05398977  0.05331416  0.05266986
#&gt;  [73]  0.05205897  0.05147715  0.05092611  0.05040219  0.04990675  0.04943672
#&gt;  [79]  0.04899317  0.04857354  0.04817866  0.04780641  0.04745739  0.04712990
#&gt;  [85]  0.04682435  0.04653935  0.04627519  0.04603077  0.04580625  0.04560078
#&gt;  [91]  0.04541444  0.04524658  0.04509721  0.04496587  0.04485253  0.04475688
#&gt;  [97]  0.04467886  0.04461828  0.04457508  0.04454919</div><div class='input'><span class='fu'>max</span>(<span class='no'>sl</span>)/<span class='fu'>min</span>(<span class='no'>sl</span>)</div><div class='output co'>#&gt; [1] 1638.865</div><div class='input'>
<span class='fu'>plot</span>(<span class='no'>ss</span>/<span class='fu'>sum</span>(<span class='no'>ss</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>t</span><span class='kw'>=</span><span class='st'>'b'</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>1</span>))</div><div class='input'><span class='fu'>lines</span>(<span class='no'>sl</span>/<span class='fu'>sum</span>(<span class='no'>sl</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>t</span><span class='kw'>=</span><span class='st'>'b'</span>)</div><div class='img'><img src='simulateGaussianNullsFromSigma-5.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Gilles Blanchard, Pierre Neuvial and Etienne Roquain

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Benjamin Sadacca, Gilles Blanchard, <a href='https://www.math.univ-toulouse.fr/~pneuvial/'>Pierre Neuvial</a>, Etienne Roquain.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
