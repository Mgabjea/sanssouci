<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Binomial proportion tests for each row of a matrix — rowBinomialTests • sansSouci</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Binomial proportion tests for each row of a matrix — rowBinomialTests" />
<meta property="og:description" content="Binomial proportion tests for each row of a matrix" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sansSouci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/IIDEA.html">IIDEA: Interactive Inference for Differential Expression Analyses</a>
    </li>
    <li>
      <a href="../articles/Simes_equi-correlation.html">Conservativeness of the Simes inequality under positive dependence</a>
    </li>
    <li>
      <a href="../articles/confidenceCurves_localized.html">Confidence curves for structured hypotheses</a>
    </li>
    <li>
      <a href="../articles/jointErrorRateCalibration_simulations.html">Joint Error Rate calibration</a>
    </li>
    <li>
      <a href="../articles/post-hoc_differential-expression.html">Permutation-based post hoc inference for differential gene expression studies</a>
    </li>
    <li>
      <a href="../articles/post-hoc_fMRI.html">Permutation-based post hoc inference for fMRI studies</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pneuvial/sanssouci/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Binomial proportion tests for each row of a matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/pneuvial/sanssouci/blob/master/R/rowBinomialTests.R'><code>R/rowBinomialTests.R</code></a></small>
    <div class="hidden name"><code>rowBinomialTests.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Binomial proportion tests for each row of a matrix</p>
    </div>

    <pre class="usage"><span class='fu'>rowBinomialTests</span><span class='op'>(</span>
  <span class='va'>mat</span>,
  <span class='va'>categ</span>,
  alternative <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"two.sided"</span>, <span class='st'>"less"</span>, <span class='st'>"greater"</span><span class='op'>)</span>,
  warn <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mat</th>
      <td><p>A numeric matrix whose rows correspond to variables and columns to
observations</p></td>
    </tr>
    <tr>
      <th>categ</th>
      <td><p>Either a numeric vector of <code>n</code> categories in \(0, 1\) for
the observations, or a <code>n x B</code> matrix stacking <code>B</code> such vectors
(typically permutations of an original vector of size <code>n</code>)</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>A character string specifying the alternative hypothesis.
Must be one of "two.sided" (default), "greater" or "less". As in
<code><a href='https://rdrr.io/r/stats/binom.test.html'>binom.test</a></code>, alternative = "greater" is the alternative that
class 1 is shifted to the right of class 0.</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>A boolean value indicating whether to issue a warning if
<code>alternative=="two-sided"</code>. Defaults to <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the following components:</p><dl>
<dt>statistic</dt><dd><p>the value of the statistics</p></dd>
<dt>p.value</dt><dd><p>the p-values for the tests</p></dd>
<dt>estimate</dt><dd><p>the difference between observed group proportions</p></dd>
</dl><p>Each of these elements is a matrix of size <code>nrow(mat) x B</code>, coerced to a vector of length <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(mat)</a></code> if <code>B=1</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that the return element 'estimate' is inconsistent with the
element 'estimate' returned by 'binomial.test', which is "the estimated
probability of success". We find it more sensible to return an estimate of
the effect size (as e.g. done by 't.test'))</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>binom.test</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Gilles Blanchard, Pierre Neuvial and Etienne Roquain</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>alt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"two.sided"</span>, <span class='st'>"less"</span>, <span class='st'>"greater"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>n0</span> <span class='op'>&lt;-</span> <span class='fl'>60</span>; <span class='va'>n1</span> <span class='op'>&lt;-</span> <span class='fl'>40</span>
<span class='va'>mat0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>*</span><span class='va'>n0</span>, size <span class='op'>=</span> <span class='fl'>1</span>, prob <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='va'>n0</span><span class='op'>)</span>
<span class='va'>mat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>*</span><span class='va'>n1</span>, size <span class='op'>=</span> <span class='fl'>1</span>, prob <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='va'>n1</span><span class='op'>)</span>
<span class='va'>mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>mat0</span>, <span class='va'>mat1</span><span class='op'>)</span>
<span class='va'>cls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, times <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>n0</span>, <span class='va'>n1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>fbt</span> <span class='op'>&lt;-</span> <span class='fu'>rowBinomialTests</span><span class='op'>(</span><span class='va'>mat</span>, categ <span class='op'>=</span> <span class='va'>cls</span>, alternative <span class='op'>=</span> <span class='va'>alt</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Two-sided p-value not vectorized yet! Looping for now.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>fbt</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 3
#&gt;  $ statistic: num [1:100] 0 2 0 1 1 0 1 1 1 1 ...
#&gt;  $ p.value  : num [1:100] 0.0762 1 1 0.4895 1 ...
#&gt;  $ estimate : num [1:100] -0.08333 0 -0.01667 0.00833 -0.00833 ...</div><div class='input'>
<span class='co'># compare with ordinary binom.test:</span>
<span class='va'>pbt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span>, FUN<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>ii</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>ii</span>, <span class='va'>cls</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>ii</span>, <span class='va'>cls</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span>
  <span class='va'>bt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/binom.test.html'>binom.test</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x0</span><span class='op'>)</span>, alternative <span class='op'>=</span> <span class='va'>alt</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>statistic <span class='op'>=</span> <span class='va'>bt</span><span class='op'>[[</span><span class='st'>"statistic"</span><span class='op'>]</span><span class='op'>]</span>, p.value <span class='op'>=</span> <span class='va'>bt</span><span class='op'>[[</span><span class='st'>"p.value"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>fbt</span><span class='op'>$</span><span class='va'>p.value</span><span class='op'>-</span><span class='va'>pbt</span><span class='op'>[</span>, <span class='st'>"p.value"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>1e-10</span><span class='op'>)</span>  <span class='co'>## same results</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>fbt</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>-</span><span class='va'>pbt</span><span class='op'>[</span>, <span class='st'>"statistic.number of successes"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>1e-10</span><span class='op'>)</span>  <span class='co'>## same results</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.math.univ-toulouse.fr/~pneuvial/'>Pierre Neuvial</a>, <a href='https://durandg12.github.io/'>Guillermo Durand</a>, Nicolas Enjalbert-Courrech, <a href='https://marie-perrotdockes.github.io/'>Marie Perrot-Dockès</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


